
























                        ПРИЛОЖЕНИЕ  "В"
                    СИГНАЛЫ АВТОМАТИКИ
                    И АЛГОРИТМЫ
                   СТАНКА МА655А12
              


























ОГЛАВЛЕНИЕ



В.1	Сигналы автоматики	3
В.1.1	Непрерывно контролируемые входные сигналы	4
В.2	Алгоритмы технологических функций	5
В.2.1	Определение кода диапазона шпинделя	6
В.2.2	Определение кода инструмента	6
В.2.3	Разжим инструмента	6
В.2.4	Магазин вниз	6
В.2.5	Поиск заданного гнезда	7
В.2.6	Магазин вверх	7
В.2.7	Зажим инструмента	7
В.2.8	Вращение шпинделя с ползучей скоростью	8
В.2.9	Ориентация шпинделя	8
В.2.10	Разориентация шпинделя	8
В.2.11	Включение станка	9
В.2.12	Выключение станка	9
В.2.13	Включение шпинделя (M03, M04)	10
В.2.14	Выключение шпинделя (M05)	10
В.2.15	Смена диапазона шпинделя (M41, M42)	11
В.2.16	Смена инструмента (М06)	12
В.2.17	Включение охлаждения воздухом (М07)	13
В.2.18	Включение охлаждения жидкостью (М08)	13
В.2.19	Выключение охлаждения (М09)	13
В.2.20	Запуск шпинделя с охлаждением жидкостью (М13,М14)	13























Сигналы автоматики

Сигналы автоматики станка можно разделить на две группы: 

входные сигналы- сигналы передающие в систему информацию о состоянии различных исполнительных механизмов.
Передача происходит путем подачи по каналу связи аналогового напряжения (0, 5V), которое преобразуется в системе в дискретный цифровой сигнал 0 или 1. 

Обработка одних входных сигналов ведется непрерывно (в каждом временном такте системы), состояние других опрашивается в процессе исполнения алгоритмов определенных технологических функций.

выходные сигналы- сигналы управляющие включением исполнительных механизмов.
Цифровой код выходного сигнала (0 или 1) преобразуется в напряжение (0 или 24V соответственно) которым включается, связанный с данным сигналом, исполнительный механизм.







































3.8.1 Непрерывно контролируемые входные сигналы

Перечень непрерывно контролируемых входных сигналов для станка МА655А12 приведен в таблице В.1.

                                                                                                                 Таблица В.1

  1
  2
3
                                      4
      5





31  
204
0
73. Станок включен в наладке
Станок
33       
171
0
65. Нет готовности станка
Станок
34      
190
0
66. Сработали аварийные выключатели
Станок
35 
192
0
67. Сработал автомат цепи XYZ
Станок
36
194
0
68. Давление в гидросистеме не норма
Станок
37
198
0
72. Сработал автомат питания 24 В
Станок
38
191
0
71. Сработал автомат УН8, S
Станок
59
193 
1
74. Перегрев гидростанции
Станок





45
169
1
81. Сигнал N =0 
Цикл*
46 
170
0
83. N шпинделя не равны заданным
Цикл*
65
141
0
87. Нет зажима инструмента
Цикл*
66
162
1
87. Нет зажима инструмента
Цикл*
67
166
0
96. Магазин не вверху
Цикл*
68
164
1
96. Магазин не вверху 
Цикл*
81
163
0
101. Нет разориентации шпинделя
Цикл*
72
161
1
101. Нет разориентации шпинделя
Цикл*
44
173
0
89. Отказ привода S
Цикл*





41
174 
0
107. Отказ привода X
Цикл**
42
175 
0
108. Отказ привода Y
Цикл**
43
176 
0
109. Отказ привода Z
Цикл**
47
138 
0
93. Ось Z не разжата
Цикл**
51
189
0
94. Сработала защита СОЖ
Цикл
57
185
0
95. Сработала защита вентилятора ПГД
Цикл





49
187
0
148. Сработала защита ССЦ 
Цикл до М6
50
188
0
153. Сработала защита ССИ
Цикл до М6
52
196
0
154. Уровень масла ССЦ не норма
Цикл до М6
53
197
0
150. Уровень масла ССИ не норма
Цикл до М6
54
200
0
146. Нет смазки фрезерной головки
Цикл до М6
55
201 
0
151. Дозаторы ССИ не заполнены
Цикл до М6
56
195
1
147. Фильтр УН8 засорен
Цикл до М6
58
186
0
155. Сработала защита вентилятора УН8
Цикл до М6






где:
1- номер сигнала в системе, определен в таблице дискретных
     сигналов файла BASE.INI (см. Приложение А, Таблица 2.1);   
2-  номер провода, подведенного от станка к системе;
3-  значение сигнала при котором возникает ошибка;
4- номер и текст ошибки (см. Приложение А, файл ERRORS.INI);
5- действие, выполняемое при наличии данной ошибки:



Станок- отключение станка;

Система непрерывно контролирует значения рассогласования по всем осям.
Если по какой-либо оси оно превысит значение рассогласования до СТОП СТАНКА (6.2.1), система выдает ошибку "Предельное рассогласование по <имя оси>" (ошибки № 75..77 в ERRORS.INI, см. А.2) и выключит станок.

Цикл- останов движения, выключение шпинделя, 

* опрос сигналов состояния шпинделя ведется при включенном шпинделе. Включение выполняется функциями М3,М4,М13.М14 (см. 8.7.12),  
Если шпиндель не запущен, с помощью указанных функций- привод шпинделя отключен, контроль сигналов состояния шпинделя не ведется.

** если приходит ошибка с привода какой либо оси система выполняет  выключение привода данной оси, при возникновении ошибки "Ось Z не разжата" производится выключение 
привода оси Z;

Если по какой-либо оси рассогласование превысит значение до СТОП ЦИКЛА (6.2.1), система выдает ошибку "Рассогласование по <имя оси>" (ошибки № 110..112 в ERRORS.INI, см. А.2) и выключит соответствующий привод.


Цикл до М6- если при отработке управляющей программы встречен оператор М06 (сам оператор не отрабатывается) выполняется- останов движения, выключение шпинделя, если М06 нет- просто выдается сообщения об ошибке.
 

Алгоритмы технологических функций

Ниже приведены алгоритмы по которым система ведет управление
автоматикой станка МА655А12.

Входные сигналы обозначены R[n], выходные W[n], 
где n- порядковый номер сигнала (см. Приложение А, Таблица 2),

( - системная переменная, задает время ожидания сигналов в циклах автоматики станка, устанавливается в режиме "Наладка" окне "Установки" или в файле конфигурации BASE.INI (см. Приложение А, Таблица 5.3).

( - системная переменная, задает время паузы в циклах автоматики станка, устанавливается в режиме "Наладка" окне "Установки" или в файле конфигурации BASE.INI (см. Приложение А, Таблица 5.3).

Действия системы, в зависимости от номера выставленной ошибки:
65...80     - выключение станка;
81...144   - стоп цикла (останов движения с последующим остановом шпинделя);
145...160 - стоп цикла до первой операции М06 (смены инструмента), 
                   если М06 нет - информирование об ошибке.
                   





3.8.2 Определение кода диапазона шпинделя

Код равен 1, если установлен первый диапазон, 
2-если второй, 0- если диапазон не определен.
* если (R[82] =0 и R[83] =0) или (R[82] =1 и R[83] =1)- код диапазона равен 0, завершить алгоритм;
* если R[82] =1 и R[83] =0 - код диапазона равен 1, завершить алгоритм;
* если R[83] =1 и R[82] =0 - код диапазона равен 2;
конец алгоритма

3.8.3 Определение кода инструмента

Системная переменная Т0 принимает значения установленного инструмента 1..8, или 0, если значение не определено. 

* опросить R[73] ... R[80], если одно из значений равно 1, а остальные нулю установить 
     значение Т0 в соответствии с номером соответствующего сигнала, в любом другом случае
     значение не определено и Т0 =0.  
конец алгоритма

3.8.4 Разжим инструмента

Условия выполнения:
* если R[66] =1 и R[65] =0 -выдать сообщение 35, завершить алгоритм.
* если шпиндель не остановлен -выдать сообщение 41, завершить алгоритм; 
Сигнал разжим инструмента
* W[112] =0; W[113] =1;
* если R[65] (0 или R[66] (1  в течении ( сек- выставить ошибку 88, завершить алгоритм;
Снять напряжение с золотников
* W[113] =0;
конец алгоритма

3.8.5 Магазин вниз

Условия выполнения:
* если R[68] =1 и R[67] =0 -выдать сообщение 51, завершить алгоритм.
* если R[65] (0 или R[66] (1  в течении 5 сек- выставить ошибку 88, завершить алгоритм;
Сигнал магазин вниз
* W[105] =0; W[106] =1;
* если R[67] (0 или R[68] (1  в течении ( сек- выставить ошибку 97, завершить алгоритм;
Снять напряжение с золотников
* W[106] =0;
конец алгоритма








3.8.6 Поиск заданного гнезда

Условия выполнения:
* если R[67] (0 или R[68] (1  в течении 5 сек- выставить ошибку 97, завершить алгоритм;
* определить номер гнезда n 
     (функция может программироваться как отдельная Н-функция или в функции М06);
Сигнал поворота короны
* W[118] =0; W[107] =1;
* если R[n] (1  в течении 30 сек- выставить ошибку 103, завершить алгоритм;
* пауза на выбег под реверс 0.3 с;
Реверс короны
* W[107] =0; W[118] =1;
* если R[n] (1  в течении ( сек- выставить ошибку 103, завершить алгоритм;
Снять напряжение с золотников
* W[118] =0;
конец алгоритма

3.8.7 Магазин вверх

Условия выполнения:
* если R[67] =1 и R[68] =0 -выдать сообщение 52, завершить алгоритм.
* если R[81] (0 или R[72] (1  в течении 5 сек- выставить ошибку 100, завершить алгоритм;
* если R[65] (0 или R[66] (1  в течении 5 сек- выставить ошибку 88, завершить алгоритм;
Сигнал магазин вверх
* W[106] =0; W[105] =1;
* если R[68] (0 или R[67] (1  в течении ( сек- выставить ошибку 96, завершить алгоритм;
* если R[70] (1  в течении ( сек- выставить ошибку 99, завершить алгоритм;
Снять напряжение с золотников
* W[105] =0;
конец алгоритма

3.8.8 Зажим инструмента

Условия выполнения:
* если R[65] =1 и R[66] =0 -выдать сообщение 36, завершить алгоритм.
Сигнал зажим инструмента
* W[113] =0; W[112] =1;
* если R[66] (0 или R[65] (1  в течении ( сек- выставить ошибку 87, завершить алгоритм;
Снять напряжение с золотников
* W[113] =0;
конец алгоритма











3.8.9 Вращение шпинделя с ползучей скоростью

Условия выполнения:
* если R[81] (1  или R[72] (0- выставить ошибку 101, завершить алгоритм; 
* если R[65] (1  или R[66] (0- выставить ошибку 87, завершить алгоритм; 
* если R[67] (1  или R[68] (0- выставить ошибку 96, завершить алгоритм; 
Включение привода S
* W[102] =1;
* если R[44] (1 в течении ( сек- выставить ошибку 89, завершить алгоритм;
* выдать в ЦАП значение, соответствующее вращению шпинделя с ползучей скоростью по часовой стрелке (см. А.1, Таблица 4.1, поз. 20);
* если R[45] (0 в течении ( сек- выставить ошибку 81, завершить алгоритм;
* задать длительность выполнения (по времени либо по удержанию кнопки);
* остановить вращение шпинделя (М05).
конец алгоритма

3.8.10 Ориентация шпинделя

Условия выполнения:
* если R[72] =1 и R[81] =0 -выдать сообщение 54, завершить алгоритм.
* остановить вращение шпинделя (М05).
* определить код диапазона шпинделя (В2.1);
* если диапазон шпинделя неопределен - выставить ошибку 86, завершить алгоритм;
* если R[65] (1 или R[66] (0  в течении ( сек- выставить ошибку 87, завершить алгоритм;
Включение привода S
* W[102] =1;
* если R[44] (1 в течении ( сек- выставить ошибку 89, завершить алгоритм;
* выдать в ЦАП значение, соответствующее вращению шпинделя с ползучей скоростью по часовой стрелке (см. А.1, Таблица 4.1, поз. 20);
* если R[71] (1 в течении ( сек- выставить ошибку 102, завершить алгоритм;
* остановить вращение шпинделя (М05).
Сигнал доворота и фиксации шпинделя
* W[117] =0; W[116] =1;
* если R[81] (0 или R[72] (1  в течении ( сек- выставить ошибку 100, завершить алгоритм;
Снять напряжение с золотников
* W[116] =0;
конец алгоритма

3.8.11 Разориентация шпинделя

Условия выполнения:
* если R[81] =1 и R[72] =0 -выдать сообщение 55, завершить алгоритм.
Сигнал расфиксации шпинделя
* W[116] =0; W[117] =1;
* если R[72] (0 или R[81] (1  в течении ( сек- выставить ошибку 101, завершить алгоритм;
Снять напряжение с золотников
* W[117] =0;
конец алгоритма




3.8.12 Включение станка

Проверка аварийных выключателей и силовых автоматов
* если R[37] (1 в течении 5 сек - выставить ошибку 72, завершить алгоритм; 
* если R[34] (1 в течении 5 сек - выставить ошибку 66, завершить алгоритм; 
* если R[38] (1 в течении 5 сек - выставить ошибку 71, завершить алгоритм; 
* если R[35] (1 в течении 5 сек - выставить ошибку 67, завершить алгоритм; 
* если R[31] (1 в течении 5 сек - выставить ошибку 73, завершить алгоритм; 
Cигнал готовности
* W[98] =1;
* если R[33] (1 в течении ( сек- выставить ошибку 65, завершить алгоритм;
Набор давления гидростанции
* если R[36] (1 в течении ( сек- выставить ошибку 68, завершить алгоритм;
Силовое включение приводов подач и шпинделя
* W[111] =1; 
* Пауза ( сек;
Включение приводов подач
* W[99] =1;
* если R[41] (1 в течении ( сек- выставить ошибку 107, завершить алгоритм;
* W[100] =1; 
* если R[42] (1 в течении ( сек- выставить ошибку 108, завершить алгоритм;
* W[101] =1;
* если R[43] (1 в течении ( сек- выставить ошибку 109, завершить алгоритм;
Разжим оси Z
* W[103] =1;
* если R[47] (1 в течении ( сек- выставить ошибку 93, завершить алгоритм;
* Пауза ( сек;
Контроль состояния всех основных сигналов
* если R[37] (1 в течении 5 сек - выставить ошибку 72, завершить алгоритм; 
* если R[34] (1 в течении 5 сек - выставить ошибку 66, завершить алгоритм; 
* если R[38] (1 в течении 5 сек - выставить ошибку 71, завершить алгоритм; 
* если R[35] (1 в течении 5 сек - выставить ошибку 67, завершить алгоритм; 
* если R[31] (1 в течении 5 сек - выставить ошибку 73, завершить алгоритм; 
* если R[33] (1 в течении 5 сек - выставить ошибку 65, завершить алгоритм; 
Считать состояние кодов:
* коробки передач шпинделя (В.2.1);
* магазина инструментов (В.2.2).
установить системный флаг "станок включен" в 1;
конец алгоритма

3.8.13 Выключение станка

Обнулить все выходные сигналы кроме сигнала "Удержание системы"
* W[98]..W[120] =0
конец алгоритма



 




3.8.14 Включение шпинделя (M03, M04)

* если активен автоматический выбор диапазона М40 -определить диапазон ступени
      по коду S и вызвать функцию установки диапазона (В.2.15).
Проверка условий запуска шпинделя
* если S шпинделя не задано- выставить ошибку 84, завершить алгоритм; 
* определить код диапазона шпинделя (В.2.1);
* если диапазон шпинделя неопределен - выставить ошибку 86, завершить алгоритм;
* если S не находится в пределах установленного диапазона шпинделя- 
     выставить ошибку 85, завершить алгоритм;
* если R[81] (1 или R[72] (0 в течении 5 сек - выставить ошибку 101, завершить алгоритм; 
* если R[65] (1 или R[66] (0 в течении 5 сек - выставить ошибку 87, завершить алгоритм; 
* если R[67] (1 или R[68] (0 в течении 5 сек - выставить ошибку 96, завершить алгоритм; 
* если значение S с учетом корректора выходит за границу диапазона ступени -установить 
      его равным граничному;
Включение привода S
* W[102] =1;
* если R[44] (1 в течении ( сек- выставить ошибку 89, завершить алгоритм;
* выдать в ЦАП значение, соответствующее заданному  S  с учетом коррекции и направления вращения;
* если R[45] (0 в течении ( сек- выставить ошибку 81, завершить алгоритм;
* если R[46] (1 в течении ( сек- выставить ошибку 83, завершить алгоритм;
* установить системный флаг "шпиндель запущен" в (1 
     (по нему ведется непрерывный опрос сигналов состояния шпинделя)
конец алгоритма

3.8.15 Выключение шпинделя (M05)

* установить в 0 задание значение ЦАПа по каналу S, при этом текущее значение начнет
     плавно приближаться к заданному со скоростью, установленной в переменной А(S)
     см Приложение А. Таблица 5.1.		 
Если шпиндель запущен (см. В.2.13) выполняем "мягкое" торможение:
* если R[45] (1 в течении 5 сек- выставить ошибку 82;
     (допускается проводить контроль останова не по датчику N =0, а по факту достижения 
      текущей дискретой ЦАПа значения 0). 
* Пауза ( сек;
Выключить привод шпинделя
* W[102] =0;
* установить системный флаг "шпиндель запущен" в 0; 
Выключить подачу охладителя
* W[108] =0;
* W[109] =0;
конец алгоритма










3.8.16 Смена диапазона шпинделя (M41, M42)

* если задан код М40 -выдать сообщение 58;
* определить код диапазона шпинделя;
* если текущий код равен заданному- завершить алгоритм;
* сохранить текущее состояние охладителя;
* сохранить текущее состояние шпинделя (вкл/выкл, S, направление);
* выключить шпиндель, алгоритм М05;
Проверка условий запуска шпинделя
* если R[81] (1  или R[72] (0 в течении 5 сек - выставить ошибку 101, завершить алгоритм; 
* если R[65] (1  или R[66] (0 в течении 5 сек - выставить ошибку 87, завершить алгоритм; 
* если R[67] (1  или R[68] (0 в течении 5 сек - выставить ошибку 96, завершить алгоритм; 
Включение привода S
* W[102] =1;
* если R[44] (1 в течении ( сек- выставить ошибку 89, завершить алгоритм;
* выдать в ЦАП значение, соответствующее вращению шпинделя с ползучей скоростью;
* если R[45] (0 в течении ( сек- выставить ошибку 81, завершить алгоритм;
Выполнить переключение диапазона
* W[115] =0, W[114] =1 при включении первого диапазона,
* W[114] =0, W[115] =1 при включении второго диапазона;
* если в течении ( сек заданный код не устанавливается- выставить ошибку 86, завершить алгоритм;
Снять напряжение с золотников
* W[114] =0, W[115] =0;
* вернуть предыдущие состояния шпинделя и охладителя; 
конец алгоритма





























3.8.17 Смена инструмента (М06)

* если в буфере присутствует ошибка с номером 145...160- выдать команду на стоп цикла, завершить алгоритм;
* определить код инструмента, если действующий код равен заданному - завершить алгоритм;
* если ось Z не в позиции смены -выставить ошибку 104, завершить алгоритм;
* сохранить текущее состояние охладителя;
* сохранить текущее состояние шпинделя (вкл/выкл, S, направление);
* выключить шпиндель, алгоритм М05;
* выполнить функцию -ориентация шпинделя (В.2.9), если при выполнении данной функции возникла ошибка -завершить алгоритм;
Проверка условий 
* если R[81] (0  или R[72] (1  в течении 5 сек- выставить ошибку 100, завершить алгоритм; 
* если R[67] (1  или R[68] (0  в течении 5 сек- выставить ошибку 96, завершить алгоритм; 
* выполнить функцию -разжим инструмента (В.2.3), если при выполнении данной функции возникла ошибка -завершить алгоритм;
* выполнить функцию -магазин вниз (В.2.4), если при выполнении данной функции возникла ошибка -завершить алгоритм;
* выполнить функцию - поиск заданного гнезда (В.2.5), если при выполнении данной функции возникла ошибка -завершить алгоритм;
Включить обдув шпинделя
* W[119] =1;
* выполнить функцию -магазин вверх (В.2.6), если при выполнении данной функции возникла ошибка -завершить алгоритм;
Проверка условий 
* если R[81] (0  или R[72] (1 в течении 5 сек -выставить ошибку 100, завершить алгоритм; 
* если R[67] (1  или R[68] (0 в течении 5 сек- выставить ошибку 96, завершить алгоритм; 
* выполнить функцию -зажим инструмента (В.2.7), если при выполнении данной функции возникла ошибка -завершить алгоритм;
Выключить обдув шпинделя
* W[119] =0;
Проверка условий 
* если R[67] (1  или R[68] (0 в течении 5 сек- выставить ошибку 96, завершить алгоритм; 
* выполнить функцию -разориентация шпинделя (В.2.10), если при выполнении данной функции возникла ошибка -завершить алгоритм;
конец алгоритма



















3.8.18 Включение охлаждения воздухом (М07)

Проверка условий 
* если код переключателя управления охлаждением равен 0 или 1 -выдать сообщение 39, завершить алгоритм. 
* если код переключателя управления охлаждением не равен 0..2 -выдать сообщение 13, завершить алгоритм. 
* если код переключателя управления охлаждением равен 2 -включить воздух 
* W[109] =1;
* выдать сообщение 57.
конец алгоритма


3.8.19 Включение охлаждения жидкостью (М08)

* Проверка условий 
* если код переключателя управления охлаждением равен 0 или 1 -выдать сообщение 39, завершить алгоритм. 
* если код переключателя управления охлаждением не равен 0..2 -выдать сообщение 13, завершить алгоритм. 
* если код переключателя управления охлаждением равен 2 -включить подачу жидкости 
* W[108] =1;
* выдать сообщение 37.
конец алгоритма


3.8.20 Выключение охлаждения (М09)

Проверка условий 
* если код переключателя управления охлаждением равен 0 или 1 -выдать сообщение 39, завершить алгоритм. 
* если код переключателя управления охлаждением не равен 0..2 -выдать сообщение 13, завершить алгоритм. 
* если код переключателя управления охлаждением равен 2 -выключить подачу воздуха и жидкости; 
* W[108] =0; W[109] =0;
* выдать сообщение 38.
конец алгоритма


3.8.21 Запуск шпинделя с охлаждением жидкостью (М13,М14)

* выполнить алгоритм включения шпинделя (В2.8), если при выполнении алгоритма В2.8 возникла ошибка -завершить данный алгоритм; 
Включить подачу охлаждающей жидкости:
* W[108] =1; 
конец алгоритма

Приложение "В"   Сигналы автоматики и алгоритмы станка МА655А12                              11
????????????????????????????????????????

